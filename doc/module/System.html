<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
	  PUBLIC "-//W3C//DTD XHTML 1.1//EN"
	  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<!-- $Id: contents.html 11393 2008-05-11 06:56:12Z topia $ -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>System 関係のモジュール - Tiarra Documentation</title>
    <link rel="stylesheet" type="text/css" href="../default.css" />
  </head>
  <body>
    <div class="header">
      <h1>System 関係のモジュール</h1>
    </div>

    <hr class="sep" />

    <div class="pane-main">
      
      <div id="module-System::Error" class="module">
        <div class="module-header"><h2 title="サーバーからのERRORメッセージをNOTICEに埋め込む">System::Error</h2>
          <span class="description">サーバーからのERRORメッセージをNOTICEに埋め込む</span></div>
        <div class="content">
	  <p class="comment">
これをoffにするとクライアントにERRORメッセージがそのまま送られます。<br />
クライアントとの間ではERRORメッセージは主に切断警告に使われており、<br />
そのまま流してしまうとクライアントが混乱する可能性があります。<br />
&nbsp;&nbsp;設定項目はありません。<br />
</p>
<p class="comment">
このモジュールを回避してERRORメッセージをクライアントに送りたい場合は、<br />
remarkのsend-error-as-is-to-clientを指定してください。<br />
</p>

        </div>
      </div>

      
      <hr class="sep" />
      
      
      <div id="module-System::LivePatch" class="module">
        <div class="module-header"><h2 title="Live Patch.">System::LivePatch</h2>
          <span class="description">Live Patch.</span></div>
        <div class="content">
	  <p class="comment">
main/* に対する実行時パッチ<br />
起動/ロード時に確認は行われるが, 実際の適用は指示があるまで行われない.<br />
</p>
<p class="comment">
対応している箇所.<br />
ModuleManager / reload_modules_if_modified / r3004 =&gt; r8809<br />
LinedINETSocket / connect / r3004 =&gt; r8930<br />
Configuration::Block / equals / r3004 =&gt; r11868<br />
</p>
<p class="comment">
/livepatch check で確認.<br />
/livepatch apply で適用.<br />
</p>
<div class="element"><span class="key">command</span>:<span class="value">livepatch</span></div>

        </div>
      </div>

      
      <hr class="sep" />
      
      
      <div id="module-System::Macro" class="module">
        <div class="module-header"><h2 title="新規にコマンドを追加し、そのコマンドが使われた時に特定の動作をまとめて実行します。">System::Macro</h2>
          <span class="description">新規にコマンドを追加し、そのコマンドが使われた時に特定の動作をまとめて実行します。</span></div>
        <div class="content">
	  <p class="comment">
書式: &lt;コマンド&gt; &lt;動作&gt;<br />
コマンド&quot;switch&quot;を追加して、それが使われると<br />
#a@ircnet,#b@ircnet,#c@ircnetにjoinして、<br />
#d@ircnet,#e@ircnet,#f@ircnetからpartする例。<br />
</p>
<div class="element"><span class="key">macro</span>:<span class="value">switch join #a@ircnet,#b@ircnet,#c@ircnet</span></div>
<div class="element"><span class="key">macro</span>:<span class="value">switch part #d@ircnet,#e@ircnet,#f@ircnet</span></div>

        </div>
      </div>

      
      <hr class="sep" />
      
      
      <div id="module-System::NotifyIcon::Win32" class="module">
        <div class="module-header"><h2 title="タスクトレイにアイコンを表示する。">System::NotifyIcon::Win32</h2>
          <span class="description">タスクトレイにアイコンを表示する。</span></div>
        <div class="content">
	  <p class="comment">
タスクトレイにアイコンを表示します。<br />
クリックすると表示非表示を切り替えることができ、右クリックすると<br />
Reload と Exit ができるコンテキストメニューを表示します。<br />
多少反応が鈍いかもしれませんがちょっと待てば出てくると思います。<br />
</p>
<p class="comment">
Win32::GUI を必要とします。<br />
コンテキストメニューは表示している間処理をブロックしています。<br />
</p>
<p class="comment">
Win32 イベントループを処理する最大間隔を指定します。<br />
</p>
<div class="element"><span class="key">interval</span>:<span class="value">2</span></div>
<p class="comment">
通知領域に表示するアイコンを指定します。<br />
Win32::GUI の制限でちゃんとしたアイコンファイルしか指定できません。<br />
</p>
<div class="element"><span class="key">iconfile</span>:<span class="value">guiperl.ico</span></div>
<p class="comment">
モジュールが読み込まれたときにコンソールウィンドウを隠すかどうかを<br />
指定します。<br />
</p>
<div class="element"><span class="key">hide-console-on-load</span>:<span class="value">1</span></div>

        </div>
      </div>

      
      <hr class="sep" />
      
      
      <div id="module-System::Pong" class="module">
        <div class="module-header"><h2 title="サーバーからのPINGメッセージに対し、自動的にPONGを返す。">System::Pong</h2>
          <span class="description">サーバーからのPINGメッセージに対し、自動的にPONGを返す。</span></div>
        <div class="content">
	  <p class="comment">
これをoffにするとクライアントが自らPINGに応答せざるを得なくなりますが、<br />
クライアントからのPONGメッセージはデフォルトのサーバーへ送られるので<br />
デフォルト以外のサーバーからはPing Timeoutで落とされるなど<br />
全く良い事がありません。<br />
&nbsp;&nbsp;設定項目はありません。<br />
</p>

        </div>
      </div>

      
      <hr class="sep" />
      
      
      <div id="module-System::PrivTranslator" class="module">
        <div class="module-header"><h2 title="クライアントからの個人的なprivが相手に届かなくなる現象を回避する。">System::PrivTranslator</h2>
          <span class="description">クライアントからの個人的なprivが相手に届かなくなる現象を回避する。</span></div>
        <div class="content">
	  <p class="comment">
このモジュールは個人宛てのprivmsgの送信者のnickにネットワーク名を付加します。<br />
また、最後に声をかけられてから5分以内の nick 変更をクライアントに伝えます。<br />
設定項目はありませんが、 networks/channel-network-separator を ! や @ 以外に<br />
変更することをおすすめします。<br />
</p>

        </div>
      </div>

      
      <hr class="sep" />
      
      
      <div id="module-System::Raw" class="module">
        <div class="module-header"><h2 title="マスクで指定したサーバーにIRCメッセージを加工せずに直接送る。">System::Raw</h2>
          <span class="description">マスクで指定したサーバーにIRCメッセージを加工せずに直接送る。</span></div>
        <div class="content">
	  <p class="comment">
例えばQUITを送る事で一時的な切断が可能。<br />
</p>
<p class="comment">
この機能を利用するためのコマンド名。デフォルトは「raw」。<br />
「/raw ircnet quit」のようにして使う。<br />
一つ目のパラメータは送り先のネットワーク名。ワイルドカード使用可能。<br />
CHOCOA の場合、 raw がクライアントで使われてしまうので、<br />
コマンド名を変えるか、 /raw raw ircnet quit のようにする必要がある。<br />
</p>
<div class="element"><span class="key">command</span>:<span class="value">raw</span></div>

        </div>
      </div>

      
      <hr class="sep" />
      
      
      <div id="module-System::Reload" class="module">
        <div class="module-header"><h2 title="confファイルやモジュールの更新をリロードするコマンドを追加する。">System::Reload</h2>
          <span class="description">confファイルやモジュールの更新をリロードするコマンドを追加する。</span></div>
        <div class="content">
	  <p class="comment">
リロードを実行するコマンド名。省略されるとコマンドを追加しません。<br />
例えば&quot;load&quot;を設定すると、&quot;/load&quot;と発言しようとした時にリロードを実行します。<br />
この時コマンドはTiarraが握り潰すので、IRCプロトコル上で定義された<br />
コマンド名を設定すべきではありません。<br />
</p>
<div class="element"><span class="key">command</span>:<span class="value">load</span></div>
<p class="comment">
command と同じですが、サーバにもブロードキャストします。<br />
</p>
<div class="element"><span class="key">broadcast-command</span>:<span class="value">load-all</span></div>
<p class="comment">
confファイルをリロードしたときに通知します。<br />
モジュールの設定が変更されていた場合は、ここでの設定にかかわらず、<br />
モジュールごとに表示されます。1または省略された場合は通知します。<br />
</p>
<div class="element"><span class="key">conf-reloaded-notify</span>:<span class="value">1</span></div>

        </div>
      </div>

      
      <hr class="sep" />
      
      
      <div id="module-System::RemoteControl" class="module">
        <div class="module-header"><h2 title="特定の発言が送られてきたとき、それに反応してIRCコマンドを実行します。">System::RemoteControl</h2>
          <span class="description">特定の発言が送られてきたとき、それに反応してIRCコマンドを実行します。</span></div>
        <div class="content">
	  <p class="comment">
実行を許可する人間を表すマスク。<br />
</p>
<div class="element"><span class="key">mask</span>:<span class="value">*!*example@example.net</span></div>
<p class="comment">
&nbsp;構文: + &lt;nick&gt; &lt;IRC Message&gt;<br />
&nbsp;&lt;nick&gt;は反応するbotのnickを表すマスク。<br />
&nbsp;&lt;Tiarra::IRC::Message&gt;はサーバーに向けて発行するIRCメッセージ。<br />
<br />
&nbsp;例:<br />
&nbsp;+ hoge NICK [hoge]<br />
&nbsp;hogeというBOTが[hoge]にnickを変更する。<br />
</p>

        </div>
      </div>

      
      <hr class="sep" />
      
      
      <div id="module-System::Shutdown" class="module">
        <div class="module-header"><h2 title="Tiarraを終了させる。">System::Shutdown</h2>
          <span class="description">Tiarraを終了させる。</span></div>
        <div class="content">
	  <p class="comment">
クライアントから特定のコマンドが実行された時や、<br />
誰かから個人的に(privで)特定の発言が送られた時に<br />
Tiarra を終了させます。<br />
</p>
<p class="comment">
追加するコマンド。省略された場合はコマンドでのシャットダウンは無効になります。<br />
</p>
<div class="element"><span class="key">command</span>:<span class="value">shutdown</span></div>
<p class="comment">
Tiarraをシャットダウンさせるprivの発言。<br />
省略された場合はprivでのシャットダウンは無効になります。<br />
パラメータとして shutdown メッセージを指定できます。<br />
</p>
<div class="element"><span class="key">message</span>:<span class="value">shutdown</span></div>
<p class="comment">
privでのシャットダウンを許可する人。<br />
省略された場合はprivでのシャットダウンは無効になります。<br />
複数のマスクを指定した場合は、一つでもマッチするものがあればシャットダウンします。<br />
</p>
<div class="element"><span class="key">mask</span>:<span class="value">example!example@*.example.jp</span></div>

        </div>
      </div>

      
      <hr class="sep" />
      
      
      <div id="module-System::WebClient" class="module">
        <div class="module-header"><h2 title="ブラウザ上でログを見たり発言したりできます.">System::WebClient</h2>
          <span class="description">ブラウザ上でログを見たり発言したりできます.</span></div>
        <div class="content">
	  <p class="comment">
WebClient を起動させる場所の指定.<br />
</p>
<div class="element"><span class="key">bind-addr</span>:<span class="value">127.0.0.1</span></div>
<div class="element"><span class="key">bind-port</span>:<span class="value">8667</span></div>
<div class="element"><span class="key">path</span>:<span class="value">/irc</span></div>
<div class="element"><span class="key">css</span>:<span class="value">/irc/style/style.css</span></div>
<p class="comment">
上の設定をapacheでReverseProxyさせる場合, httpd.conf には次のように設定.<br />
&nbsp;ProxyPass        /irc/ http://localhost:8667/irc/<br />
&nbsp;ProxyPassReverse /irc/ http://localhost:8667/irc/<br />
&nbsp;&lt;Location /irc/&gt;<br />
&nbsp;...<br />
&nbsp;&lt;/Location&gt;<br />
</p>
<p class="comment">
ReverseProxy 利用時の追加設定.<br />
接続元が全部プロキシサーバになっちゃうのでその対応.<br />
ReverseProxy 使わず直接公開の場合は不要.<br />
</p>
<div class="element"><span class="key">extract-forwarded-for</span>:<span class="value">127.0.0.1</span></div>
<p class="comment">
&nbsp;利用する接続設定の一覧.<br />
<br />
&nbsp;空白区切りで評価する順に記述.<br />
&nbsp;使われる設定は,<br />
&nbsp;- 接続元 IP が一致する物.<br />
&nbsp;- user/passが送られてきていない(認証前/anonymous):<br />
&nbsp;&nbsp;&nbsp;- 認証不要の設定があればその設定を利用.<br />
&nbsp;&nbsp;&nbsp;- 認証不要の設定がなければ 401 Unauthorized.<br />
&nbsp;- user/passが送られてきている.<br />
&nbsp;&nbsp;&nbsp;- 一致する設定を利用.<br />
&nbsp;&nbsp;&nbsp;- 一致する設定がなければ 401 Unauthorized.<br />
</p>
<div class="element"><span class="key">allow</span>:<span class="value">private public</span></div>
<p class="comment">
許可する接続の設定.<br />
</p>
<div class="block element"><span class="block key">allow-private</span>
<div class="block content">
<p class="comment">
接続元IPアドレスの制限.<br />
</p>
<div class="element"><span class="key">host</span>:<span class="value">127.0.0.1</span></div>
<p class="comment">
認証設定.<br />
auth: &lt;user&gt; &lt;pass&gt;<br />
auth: :basic &lt;user&gt; &lt;pass&gt;<br />
auth: :softbank &lt;端末ID&gt;<br />
auth: :softbank &lt;UID&gt;<br />
auth: :au &lt;SUBNO&gt;<br />
各値(&lt;pass&gt;等)には {MD5}xxxx や {B}xxx や {CRYPT}xxx を利用可能.<br />
そのままべた書きも出来るけれど.<br />
</p>
<div class="element"><span class="key">auth</span>:<span class="value">:basic user pass</span></div>
<p class="comment">
公開するチャンネルの指定.<br />
</p>
<div class="element"><span class="key">mask</span>:<span class="value">#*@*</span></div>
<div class="element"><span class="key">mask</span>:<span class="value">*@*</span></div>
</div></div>
<div class="block element"><span class="block key">allow-public</span>
<div class="block content">
<div class="element"><span class="key">host</span>:<span class="value">*</span></div>
<div class="element"><span class="key">auth</span>:<span class="value">user2 pass2</span></div>
<div class="element"><span class="key">mask</span>:<span class="value">#公開チャンネル@ircnet</span></div>
</div></div>
<p class="comment">
デバッグフラグ.<br />
</p>
<div class="element"><span class="key">debug</span>:<span class="value">0</span></div>
<p class="comment">
保存する最大行数.<br />
</p>
<div class="element"><span class="key">max-lines</span>:<span class="value">100</span></div>
<p class="comment">
クライアントモード.<br />
owner か shared.<br />
</p>
<div class="element"><span class="key"> mode</span>:<span class="value">owner</span></div>
<p class="comment">
ログの方向.<br />
asc (旧-&gt;新) か desc (新-&gt;旧).<br />
</p>
<div class="element"><span class="key"> sort-order</span>:<span class="value">asc</span></div>
<p class="comment">
name-default 設定は VERSION 0.05 で廃止されました.<br />
# 発言BOXで名前指定しなかったときのデフォルトの名前.<br />
# mode: shared の時に使われる.<br />
-name-default: (noname)<br />
</p>
<p class="comment">
外部にTiarraさんを使っているときに, そこのネットワークを切り出して表示する.<br />
exteact-network: &lt;netname&gt; &lt;remote-sep&gt;<br />
&lt;netname&gt; ::= このTiarraさんから見たときの外部Tiarraさんのネットワーク名.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(このtiarra.confで指定しているネットワーク名)<br />
&lt;remote-sep&gt; ::= 外部Tiarraさんで使っているセパレータ.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(こっちはこのtiarra.confのではないです)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;省略すると @ と仮定.<br />
</p>
<div class="element"><span class="key">exteact-network</span>:<span class="value">tiarra</span></div>
<div class="element"><span class="key">exteact-network</span>:<span class="value">tiarra @</span></div>

        </div>
      </div>

      
      
    </div>

    <div class="pane-sidebar">
      <ul class="menu">
        
        <li><a href="#module-System::Error" title="サーバーからのERRORメッセージをNOTICEに埋め込む">System::Error</a></li>
        
        <li><a href="#module-System::LivePatch" title="Live Patch.">System::LivePatch</a></li>
        
        <li><a href="#module-System::Macro" title="新規にコマンドを追加し、そのコマンドが使われた時に特定の動作をまとめて実行します。">System::Macro</a></li>
        
        <li><a href="#module-System::NotifyIcon::Win32" title="タスクトレイにアイコンを表示する。">System::NotifyIcon::Win32</a></li>
        
        <li><a href="#module-System::Pong" title="サーバーからのPINGメッセージに対し、自動的にPONGを返す。">System::Pong</a></li>
        
        <li><a href="#module-System::PrivTranslator" title="クライアントからの個人的なprivが相手に届かなくなる現象を回避する。">System::PrivTranslator</a></li>
        
        <li><a href="#module-System::Raw" title="マスクで指定したサーバーにIRCメッセージを加工せずに直接送る。">System::Raw</a></li>
        
        <li><a href="#module-System::Reload" title="confファイルやモジュールの更新をリロードするコマンドを追加する。">System::Reload</a></li>
        
        <li><a href="#module-System::RemoteControl" title="特定の発言が送られてきたとき、それに反応してIRCコマンドを実行します。">System::RemoteControl</a></li>
        
        <li><a href="#module-System::Shutdown" title="Tiarraを終了させる。">System::Shutdown</a></li>
        
        <li><a href="#module-System::WebClient" title="ブラウザ上でログを見たり発言したりできます.">System::WebClient</a></li>
        
        <li><a href="../module-toc.html">モジュール一覧に戻る</a></li>
      </ul>
    </div>
  </body>
</html>
